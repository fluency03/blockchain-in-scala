package com.github.fluency03.blockchain
package crypto

import org.scalatest.{FlatSpec, Matchers}

class RIPEMD160Test extends FlatSpec with Matchers {

  "RIPEMD160" should "encode String to RIPEMD160 and decode it back to original." in {

    RIPEMD160.hash("173BDED8F2A2069C193E63EA30DC8FD20E815EC3642B9C24AD7002C03D1BFB9B".hex2Bytes) shouldEqual
      "88C2D2FA846282C870A76CADECBE45C4ACD72BB6".toLowerCase

    RIPEMD160.hash160Digest(("04b4d653fcbb4b96000c99343f23b08a44fa306031e0587f9e657ab4a25411" +
      "29368d7d9bb05cd8afbdf7705a6540d98028236965553f91bf1c5b4f70073f55b55d").hex2Bytes) shouldEqual
      "88C2D2FA846282C870A76CADECBE45C4ACD72BB6".hex2Bytes

    RIPEMD160.hash160(("04b4d653fcbb4b96000c99343f23b08a44fa306031e0587f9e657ab4a25411" +
      "29368d7d9bb05cd8afbdf7705a6540d98028236965553f91bf1c5b4f70073f55b55d").hex2Bytes) shouldEqual
      "88C2D2FA846282C870A76CADECBE45C4ACD72BB6".toLowerCase

    RIPEMD160.hashString("61956bf4e271df1cd88a9a7828a59c88eb7ea13c176c4d03355ac27129760673") shouldEqual
      "352b0b6bd7284755d5c685fb7793c9f4d672c5ff"
    RIPEMD160.hashString("abcd") shouldEqual "2e7e536fd487deaa943fda5522d917bdb9011b7a"
    RIPEMD160.hashString("205575f4f33a39ff47f569613a694c6321d6cdd7") shouldEqual "bd4e962413308b4a6689aa0e7cff5e419391c3db"
    RIPEMD160.hashString("bitcoin") shouldEqual "5891bf40b0b0e8e19f524bdc2e842d012264624b"
    RIPEMD160.hashString("blockchain") shouldEqual "5c403af45cae136a79eea3c7e9f79c3dd049776b"

    RIPEMD160.hashStrings(
      "61956bf4e271df1cd88a9a7828a59c88",
      "eb7ea13c176c4d03355ac27129760673") shouldEqual
      "352b0b6bd7284755d5c685fb7793c9f4d672c5ff"

    RIPEMD160.hashHex("3D7C570DCDF97F6C1823C0CE4F5ACB0878A1505992445F33BC66C7302F56C6BA") shouldEqual
      "45590A0195EB451711B9D076E4C0CD04675AAD55".toLowerCase

    RIPEMD160.hashHexs("3D7C570DCDF97F6C1823C0CE4F", "5ACB0878A1505992445F33BC66C7302F56C6BA") shouldEqual
      "45590A0195EB451711B9D076E4C0CD04675AAD55".toLowerCase

    RIPEMD160.hashHexs("3D7C570DCDF9" + "7F6C1823C0CE4F", "5ACB0878A1505992445" + "F33BC66C7302F56C6BA") shouldEqual
      "45590A0195EB451711B9D076E4C0CD04675AAD55".toLowerCase

    RIPEMD160.hash("0261107E41495C0DDC3850CD205D32896133EDD2ADDEBE7D8E20E01EFD078710".hex2Bytes) shouldEqual
      "A6020CF86FECEDEEF8859C172BAA1A15A575BC6F".toLowerCase

  }

}
